import{_ as m,b as f,u as c}from"./Functions.G-etegh6.js";import{_ as h}from"./_plugin-vue_export-helper.x3n3nnut.js";import{o as i,c as r,t as p,h as a,a as y,F as v,k,g as _,i as w,j as q,r as b,f as S}from"./entry.vVFzJHlF.js";import"./nuxt-link.HmH_W_nj.js";import"./axios.dHanLt5T.js";const M={components:{Card:m},props:{title:{type:String,required:!1,default:""},items:{type:Object,required:!0},loading:{type:Boolean,required:!1,default:!1}},mounted(){window.addEventListener("scroll",this.getScrollPosition)},beforeDestroy(){window.removeEventListener("scroll",this.getScrollPosition)},methods:{getScrollPosition:f(function(){this.items.page<this.items.total_pages?window.innerHeight+window.pageYOffset>=document.body.offsetHeight-600&&!this.loading&&this.loadMore():window.removeEventListener("scroll",this.getScrollPosition)},50),loadMore(){this.$emit("loadMore")}}},x={class:"listing"},R={key:0,class:"listing__head"},N={key:0,class:"listing__title"},B={class:"listing__items"},L={key:1,class:"listing__nav"},$={key:0},C=w('<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" stroke="#2196f3"><g fill="none" fill-rule="evenodd" stroke-width="2"><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="0s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="0s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="-0.9s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="-0.9s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle></g></svg>',1),E=[C];function O(t,o,e,s,d,n){const l=m;return i(),r("div",x,[e.title?(i(),r("div",R,[e.title?(i(),r("h2",N,p(e.title),1)):a("",!0)])):a("",!0),y("div",B,[(i(!0),r(v,null,k(e.items.results,u=>(i(),_(l,{key:`card-${u.id}`,item:u},null,8,["item"]))),128))]),e.items.page<e.items.total_pages?(i(),r("div",L,[e.loading?(i(),r("div",$,E)):a("",!0)])):a("",!0)])}const g=h(M,[["render",O]]);var T={};const D={components:{SearchResults:g},data(){return{loading:!1}},head(){return{title:"Search",meta:[{hid:"og:title",property:"og:title",content:"Search"},{hid:"og:url",property:"og:url",content:`${T.FRONTEND_URL}${this.$route.path}`}],bodyAttrs:{class:"page page-search"}}},computed:{query(){return this.$route.query.q?this.$route.query.q:""},title(){return this.query?`Results For: ${this.query}`:""}},setup(){const t=c(),o=q(),e=b(null);return S(async()=>{try{if(o.query.q){const s=await t.search({query:o.query.q,page:1});e.value=s.data}else redirect("/")}catch(s){console.error({status:s.code,error:s.message})}}),{items:e}},beforeRouteEnter(t,o,e){o.path,e()},beforeRouteUpdate(t,o,e){e(),this.getResults()},beforeRouteLeave(t,o,e){const s=document.getElementById("search");e(),s&&s.value.length&&this.$store.commit("search/closeSearch")},methods:{async getResults(){if(!this.query.length){this.items=null;return}const t=await c().search({query:this.query});if(!t.data.total_results){this.items=null;return}this.items=t.data},loadMore(){this.loading=!0,c().search({query:this.query,page:this.items.page+1}).then(t=>{this.items.results=this.items.results.concat(t.data.results),this.items.page=t.data.page,this.loading=!1}).catch(()=>{this.loading=!1})}}},F={class:"main"};function P(t,o,e,s,d,n){const l=g;return i(),r("main",F,[s.items&&s.items.results.length?(i(),_(l,{key:0,title:n.title,items:s.items,loading:d.loading,onLoadMore:n.loadMore},null,8,["title","items","loading","onLoadMore"])):a("",!0)])}const A=h(D,[["render",P]]);export{A as default};
